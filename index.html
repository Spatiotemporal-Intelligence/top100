<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top 100 Rerun Records</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #0d1017;
            color: #c9d1d9;
        }
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: none; /* Hidden until loaded */
        }
    </style>
</head>
<body>
    <div id="loading">
        <h2>Loading Records...</h2>
        <div id="status">Fetching manifest...</div>
    </div>
    
    <iframe id="rerun-viewer" allow="clipboard-read; clipboard-write; web-share; accelerometer; gyroscope; xr-spatial-tracking" allowfullscreen></iframe>

    <script>
        async function load() {
            const status = document.getElementById('status');
            try {
                // 1. Fetch the list of files (generated by update_manifest.py)
                const resp = await fetch('manifest.json');
                if (!resp.ok) throw new Error('Could not load manifest.json');
                
                const files = await resp.json();
                status.textContent = `Found ${files.length} records. Launching Viewer...`;

                if (files.length === 0) {
                    throw new Error('No records found in manifest.');
                }

                // 2. Resolve absolute URLs for Rerun
                // GitHub Pages files must be publicly accessible via HTTPS
                const fileUrls = files.map(f => new URL(f, window.location.href).href);

                // 3. Construct Rerun Viewer URL
                // We pass multiple 'url' parameters
                const viewerUrl = new URL('https://app.rerun.io/version/0.29.0/');
                fileUrls.forEach(url => viewerUrl.searchParams.append('url', url));

                // 4. Load into Iframe
                const iframe = document.getElementById('rerun-viewer');
                iframe.src = viewerUrl.href;
                
                iframe.onload = () => {
                   document.getElementById('loading').style.display = 'none';
                   iframe.style.display = 'block';
                };
                
                // Fallback for load detection
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    iframe.style.display = 'block';
                }, 3000);

            } catch (err) {
                console.error(err);
                status.innerHTML = `<span style="color:#f85149">Error: ${err.message}</span><br><br>Make sure to run <code>python3 update_manifest.py</code> before committing!`;
            }
        }

        window.addEventListener('DOMContentLoaded', load);
    </script>
</body>
<<<<<<< HEAD
</html>
=======
</html>
>>>>>>> 927ee18f12395053f5bf0f9476a0ea8fc3c1ebc7
